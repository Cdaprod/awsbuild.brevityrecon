id: aws-bucket-list

info:
  name: Detect AWS S3 buckets with list
  author: Brevity in Motion
  severity: low
  tags: aws

requests:
  - method: GET
    path:
      - "https://{{BaseURL}}.s3.{{region}}.amazonaws.com"
      - "http://{{BaseURL}}.s3.{{region}}.amazonaws.com"
    payloads:
        region: /root/security/tools/nuclei/awsregions.txt
    attack: sniper
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "AmazonS3"
        part: header
      - type: word
        words:
          - "<ListBucketResult"
        part: body